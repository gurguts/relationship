<!DOCTYPE html>
<html lang="ua">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фінансове управління</title>

    <link rel="stylesheet" href="/css/finance.css">
    <link rel="stylesheet" href="/css/common.css">

    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96"/>
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg"/>
    <link rel="shortcut icon" href="/favicon/favicon.ico"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/>
    <meta name="apple-mobile-web-app-title" content="Vinteh"/>
    <link rel="manifest" href="/favicon/site.webmanifest"/>
</head>
<body>
<label class="hamburger">
    <input id="hamburger" type="checkbox">
    <svg viewBox="0 0 32 32">
        <path class="line line-top-bottom"
              d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22"></path>
        <path class="line" d="M7 16 27 16"></path>
    </svg>
</label>

<header>
    <div class="user-info">
        <span id="userName">Не вказано</span><br>
        <span id="userBalance">0</span>
    </div>
    <nav>
        <ul>
            <li id="nav-clients"><a href="/clients">
                Клієнти
            </a></li>
            <li id="nav-routes"><a href="/routes">
                Маршрути
            </a></li>
            <li id="nav-purchase"><a href="/purchase">
                Закупівлі
            </a></li>
            <li id="nav-containers"><a href="/containers">
                Тари
            </a></li>
            <li id="nav-inventory"><a href="/inventory">
                Баланс тари
            </a></li>
            <li id="nav-balance"><a href="/balance">
                Баланс грошовий
            </a></li>
            <li id="nav-finance"><a class="selected-nav" href="/finance">
                Фінанси
            </a></li>
            <li id="nav-stock"><a href="/stock">
                Склад
            </a></li>
            <li id="nav-analytics"><a href="/analytics">
                Аналітика
            </a></li>
            <li id="nav-settings"><a href="/settings" class="setting-icon-block">
                Налаштування
            </a></li>
            <li>
                <a href="#" id="logout">
                    Вихід
                </a>
            </li>
        </ul>
    </nav>
</header>

<div class="finance-container">
    <div class="finance-header">
        <h1>Фінансове управління</h1>
        <div class="action-buttons">
            <button id="create-transaction-btn" class="btn-primary">Створити транзакцію</button>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" data-tab="accounts">Рахунки та філії</button>
        <button class="tab-btn" data-tab="transactions">Транзакції</button>
    </div>

    <!-- Accounts Tab -->
    <div id="accounts-tab" class="tab-content active">
        <div id="accounts-branches-container">
            <!-- Content will be generated by JavaScript -->
        </div>
    </div>

    <!-- Transactions Tab -->
    <div id="transactions-tab" class="tab-content">
        <div class="filter-section">
            <label for="transaction-type-filter">Тип:</label>
            <select id="transaction-type-filter">
                <option value="">Всі типи</option>
                <option value="INTERNAL_TRANSFER">Перевод між рахунками</option>
                <option value="EXTERNAL_INCOME">Зовнішній прихід</option>
                <option value="EXTERNAL_EXPENSE">Зовнішній витрата</option>
                <option value="CLIENT_PAYMENT">Оплата клієнту</option>
                <option value="CURRENCY_CONVERSION">Конвертація валют</option>
            </select>
            <label for="transaction-account-filter">Рахунок:</label>
            <select id="transaction-account-filter">
                <option value="">Всі рахунки</option>
            </select>
            <label for="transaction-category-filter">Категорія:</label>
            <select id="transaction-category-filter">
                <option value="">Всі категорії</option>
            </select>
            <label for="transaction-date-from">Дата від:</label>
            <input type="date" id="transaction-date-from">
            <label for="transaction-date-to">Дата до:</label>
            <input type="date" id="transaction-date-to">
            <button id="apply-transaction-filters" class="btn-primary">Застосувати фільтри</button>
            <button id="export-transactions-btn" class="btn-secondary">Експорт в Excel</button>
        </div>
        <div class="table-container">
            <table id="transactions-table" class="data-table">
                <thead>
                <tr>
                    <th>Дата</th>
                    <th>Тип</th>
                    <th>Категорія</th>
                    <th>З рахунку</th>
                    <th>На рахунок</th>
                    <th>Сума</th>
                    <th>Валюта</th>
                    <th>Клієнт</th>
                    <th>Опис</th>
                    <th>Дії</th>
                </tr>
                </thead>
                <tbody id="transactions-body"></tbody>
            </table>
        </div>
        <div class="pagination-container">
            <button id="prev-page-btn" class="btn-secondary" disabled>Попередня</button>
            <span id="page-info">Сторінка 1 з 1</span>
            <button id="next-page-btn" class="btn-secondary" disabled>Наступна</button>
        </div>
    </div>
</div>

<!-- Create Transaction Modal -->
<div id="create-transaction-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Створити транзакцію</h2>
        <form id="transaction-form">
            <div class="form-group">
                <label for="transaction-type">Тип транзакції:</label>
                <select id="transaction-type" required>
                    <option value="">Виберіть тип</option>
                    <option value="INTERNAL_TRANSFER">Перевод між рахунками</option>
                    <option value="EXTERNAL_INCOME">Зовнішній прихід</option>
                    <option value="EXTERNAL_EXPENSE">Зовнішній витрата</option>
                    <option value="CLIENT_PAYMENT">Оплата клієнту</option>
                    <option value="CURRENCY_CONVERSION">Конвертація валют</option>
                </select>
            </div>

            <div class="form-group" id="from-account-group">
                <label for="from-account">З рахунку:</label>
                <select id="from-account"></select>
            </div>

            <div class="form-group" id="to-account-group">
                <label for="to-account">На рахунок:</label>
                <select id="to-account"></select>
            </div>

            <div class="form-group" id="conversion-account-group" style="display: none;">
                <label for="conversion-account">Рахунок:</label>
                <select id="conversion-account"></select>
            </div>

            <div class="form-group">
                <label for="transaction-category">Категорія:</label>
                <select id="transaction-category" required></select>
            </div>

            <div class="form-group" id="amount-group">
                <label for="transaction-amount">Сума:</label>
                <input type="number" id="transaction-amount" step="0.01" min="0.01" required>
            </div>

            <div class="form-group" id="currency-group">
                <label for="transaction-currency">З валюту:</label>
                <select id="transaction-currency" required></select>
            </div>

            <div class="form-group" id="conversion-currency-group" style="display: none;">
                <label for="conversion-currency">У валюту:</label>
                <select id="conversion-currency"></select>
            </div>

            <div class="form-group" id="exchange-rate-group" style="display: none;">
                <label for="exchange-rate">Курс обміну:</label>
                <input type="number" id="exchange-rate" step="0.000001" min="0.000001">
            </div>

            <div class="form-group" id="client-group" style="display: none;">
                <label for="transaction-client">Клієнт:</label>
                <div class="client-autocomplete-wrapper">
                    <input type="text" id="transaction-client" class="client-autocomplete-input" placeholder="Почніть вводити назву клієнта..." autocomplete="off">
                    <input type="hidden" id="transaction-client-id">
                    <div id="client-autocomplete-dropdown" class="client-autocomplete-dropdown"></div>
                </div>
            </div>

            <div class="form-group">
                <label for="transaction-description">Опис:</label>
                <textarea id="transaction-description" rows="3"></textarea>
            </div>

            <button type="submit" class="btn-primary">Створити</button>
        </form>
    </div>
</div>

<!-- Create/Edit Account Modal -->
<div id="create-account-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="account-modal-title">Створити рахунок</h2>
        <form id="account-form">
            <input type="hidden" id="account-id">
            <div class="form-group">
                <label for="account-name">Назва:</label>
                <input type="text" id="account-name" required>
            </div>
            <div class="form-group">
                <label for="account-description">Опис:</label>
                <textarea id="account-description" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="account-user">Користувач (опціонально):</label>
                <select id="account-user">
                    <option value="">Без користувача</option>
                </select>
            </div>
            <div class="form-group">
                <label for="account-branch">Філія (опціонально):</label>
                <select id="account-branch">
                    <option value="">Без філії</option>
                </select>
            </div>
            <div class="form-group">
                <label>Валюти:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="currency" value="UAH" checked> UAH</label>
                    <label><input type="checkbox" name="currency" value="USD"> USD</label>
                    <label><input type="checkbox" name="currency" value="EUR"> EUR</label>
                </div>
            </div>
            <button type="submit" class="btn-primary" id="account-submit-btn">Створити</button>
        </form>
    </div>
</div>

<!-- Create/Edit Branch Modal -->
<div id="create-branch-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="branch-modal-title">Створити філію</h2>
        <form id="branch-form">
            <input type="hidden" id="branch-id">
            <div class="form-group">
                <label for="branch-name">Назва:</label>
                <input type="text" id="branch-name" required>
            </div>
            <div class="form-group">
                <label for="branch-description">Опис:</label>
                <textarea id="branch-description" rows="3"></textarea>
            </div>
            <button type="submit" class="btn-primary" id="branch-submit-btn">Створити</button>
        </form>
    </div>
</div>

<!-- View Account Balances Modal -->
<div id="view-balances-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="balances-account-name">Баланси рахунку</h2>
        <table class="data-table">
            <thead>
            <tr>
                <th>Валюта</th>
                <th>Сума</th>
            </tr>
            </thead>
            <tbody id="balances-body"></tbody>
        </table>
    </div>
</div>

<!-- Edit Transaction Modal -->
<div id="edit-transaction-modal" class="modal">
    <div class="modal-content">
        <span class="close" id="close-edit-transaction-modal">&times;</span>
        <h2>Редагувати транзакцію</h2>
        <form id="edit-transaction-form">
            <input type="hidden" id="edit-transaction-id">
            
            <div class="form-group">
                <label for="edit-transaction-category">Категорія:</label>
                <select id="edit-transaction-category"></select>
            </div>

            <div class="form-group">
                <label for="edit-transaction-amount">Сума:</label>
                <input type="number" id="edit-transaction-amount" step="0.01" min="0.01" required>
            </div>

            <div class="form-group">
                <label for="edit-transaction-description">Опис:</label>
                <textarea id="edit-transaction-description" rows="3"></textarea>
            </div>

            <div class="form-group" id="edit-exchange-rate-group" style="display: none;">
                <label for="edit-transaction-exchange-rate">Курс конвертації:</label>
                <input type="number" id="edit-transaction-exchange-rate" step="0.0001" min="0.0001">
            </div>

            <div class="form-buttons">
                <button type="submit" class="btn-primary">Зберегти</button>
                <button type="button" class="btn-secondary" id="cancel-edit-transaction">Скасувати</button>
            </div>
        </form>
    </div>
</div>

<script src="/js/common.js"></script>
<script src="/js/finance.js"></script>
</body>
</html>

