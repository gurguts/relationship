<!DOCTYPE html>
<html lang="ua">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock</title>

    <link rel="stylesheet" href="/css/stock.css">
    <link rel="stylesheet" href="/css/common.css">

    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96"/>
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg"/>
    <link rel="shortcut icon" href="/favicon/favicon.ico"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/>
    <meta name="apple-mobile-web-app-title" content="Vinteh"/>
    <link rel="manifest" href="/favicon/site.webmanifest"/>
</head>
<body>
<label class="hamburger">
    <input id="hamburger" type="checkbox">
    <svg viewBox="0 0 32 32">
        <path class="line line-top-bottom"
              d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22"></path>
        <path class="line" d="M7 16 27 16"></path>
    </svg>
</label>

<header>
    <div class="user-info">
        <span id="userName">–ù–µ –≤–∫–∞–∑–∞–Ω–æ</span><br>
        <span id="userBalance">0</span>
    </div>
    <nav>
        <ul>
            <li id="nav-clients"><a href="/clients">
                –ö–ª—ñ—î–Ω—Ç–∏
            </a></li>
            <li id="nav-routes"><a href="/routes">
                –ú–∞—Ä—à—Ä—É—Ç–∏
            </a></li>
            <li id="nav-purchase"><a href="/purchase">
                –ó–∞–∫—É–ø—ñ–≤–ª—ñ
            </a></li>
            <li id="nav-sale"><a href="/sale">
                –ü—Ä–æ–¥–∞–∂—ñ
            </a></li>
            <li id="nav-containers"><a href="/containers">
                –¢–∞—Ä–∏
            </a></li>
            <li id="nav-inventory"><a href="/inventory">
                –ë–∞–ª–∞–Ω—Å —Ç–∞—Ä–∏
            </a></li>
            <li id="nav-balance"><a href="/balance">
                –ë–∞–ª–∞–Ω—Å –≥—Ä–æ—à–æ–≤–∏–π
            </a></li>
            <li id="nav-stock"><a class="selected-nav" href="/stock">
                –°–∫–ª–∞–¥
            </a></li>
            <li id="nav-analytics"><a href="/analytics">
                –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞
            </a></li>
            <li id="nav-settings"><a href="/settings" class="setting-icon-block">
                –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            </a></li>
            <li>
                <a href="#" id="logout">
                    –í–∏—Ö—ñ–¥
                </a>
            </li>
        </ul>
    </nav>
</header>

<h1>–ë–∞–ª–∞–Ω—Å –°–∫–ª–∞–¥—É</h1>

<div class="container">
    <div id="balance-container"></div>
    <div class="modal-buttons">
        <div class="button-row">
            <button class="button" id="add-entry-btn">–î–æ–¥–∞—Ç–∏ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è</button>
            <button class="button" id="move-btn">–ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è</button>
            <button class="button" id="withdraw-btn">–°–ø–∏—Å–∞—Ç–∏ –±–∞–ª–∞–Ω—Å</button>
            <button class="button" id="shipments-btn">–í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞—à–∏–Ω</button>
        </div>
        <div class="button-row">
            <button class="button" id="entries-btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω—å</button>
            <button class="button" id="transfers-btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –ø–µ—Ä–µ–º—ñ—â–µ–Ω—å</button>
            <button class="button" id="history-btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é —Å–ø–∏—Å–∞–Ω—å</button>
        </div>
        <div class="button-row">
            <button class="button" id="driver-balances-btn">–ë–∞–ª–∞–Ω—Å–∏ –≤–æ–¥—ñ—ó–≤</button>
            <button class="button" id="discrepancies-btn">–í—Ç—Ä–∞—Ç–∏ —Ç–∞ –ø—Ä–∏–¥–±–∞–Ω–Ω—è</button>
        </div>
    </div>


    <div id="history-container" class="history-container">
        <div class="history-header">
            <h3>–Ü—Å—Ç–æ—Ä—ñ—è —Å–ø–∏—Å–∞–Ω—å</h3>
            <div class="history-filter-controls">
                <button class="open-filter-modal-btn" id="open-history-filter-modal" style="display: none;">–§—ñ–ª—å—Ç—Ä–∏ —Å–ø–∏—Å–∞–Ω—å</button>
                <span id="history-filter-counter" style="display: none;">
                    <span id="history-filter-count">0</span>
                    <svg width="10" height="10" viewBox="0 0 10 10">
                        <path d="M1 1l8 8M9 1l-8 8" stroke="white" stroke-width="2"/>
                    </svg>
                </span>
                <button type="button" id="export-excel-history" class="excel-export" style="display: none;">–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
            </div>
        </div>
        <div id="filters-container" class="filters-container" style="display: none;">
            <form id="history-filters-form">
                <div class="filters">
                    <div class="filter-group">
                        <div class="filter-block">
                            <label for="withdrawal-date-from-filter">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è –≤—ñ–¥:</label>
                            <input type="date" id="withdrawal-date-from-filter" name="withdrawal_date_from">
                        </div>
                        <div class="filter-block">
                            <label for="withdrawal-date-to-filter">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è –¥–æ:</label>
                            <input type="date" id="withdrawal-date-to-filter" name="withdrawal_date_to">
                        </div>
                        <div class="select-section-items">
                            <div class="select-section-item">
                                <label for="product-id-filter">–¢–æ–≤–∞—Ä:</label>
                                <select id="product-id-filter" name="product_id" multiple></select>
                            </div>
                            <div class="select-section-item">
                                <label for="warehouse-id-filter">–°–∫–ª–∞–¥:</label>
                                <select id="warehouse-id-filter" name="warehouse_id" multiple></select>
                            </div>
                            <div class="select-section-item">
                                <label for="withdrawal-reason-id-filter">–ü—Ä–∏—á–∏–Ω–∞:</label>
                                <select id="withdrawal-reason-id-filter" name="withdrawal_reason_id" multiple></select>
                            </div>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button type="button" id="apply-filters" class="apply-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                        <span id="filter-counter" class="filter-counter"><span id="filter-count">0</span></span>
                        <button type="button" id="clear-filters" class="button">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                        <button type="button" id="export-excel-withdrawal" class="excel-export">–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
                    </div>
                </div>
            </form>
        </div>
        <table class="history-table" id="history-table">
            <thead>
            <tr>
                <th>–°–∫–ª–∞–¥</th>
                <th>–¢–æ–≤–∞—Ä</th>
                <th>–ü—Ä–∏—á–∏–Ω–∞</th>
                <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                <th>–¶—ñ–Ω–∞ –∑–∞ –∫–≥</th>
                <th>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</th>
                <th>–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è</th>
                <th>–û–ø–∏—Å</th>
                <th>–°—Ç–≤–æ—Ä–µ–Ω–æ</th>
            </tr>
            </thead>
            <tbody id="history-content"></tbody>
        </table>
        <div class="pagination">
            <button id="prev-page" disabled>–ü–æ–ø–µ—Ä–µ–¥–Ω—è</button>
            <span id="page-info">–°—Ç–æ—Ä—ñ–Ω–∫–∞ 1 –∑ 1</span>
            <button id="next-page" disabled>–ù–∞—Å—Ç—É–ø–Ω–∞</button>
        </div>
    </div>



    <div id="entries-container" class="entries-container" style="display: none;">
        <div class="entries-header">
            <h3>–Ü—Å—Ç–æ—Ä—ñ—è –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω—å</h3>
            <div class="entries-filter-controls">
                <button class="open-filter-modal-btn" id="open-entries-filter-modal" style="display: none;">–§—ñ–ª—å—Ç—Ä–∏ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω—å</button>
                <span id="entries-filter-counter" style="display: none;">
                    <span id="entries-filter-count">0</span>
                    <svg width="10" height="10" viewBox="0 0 10 10">
                        <path d="M1 1l8 8M9 1l-8 8" stroke="white" stroke-width="2"/>
                    </svg>
                </span>
                <button type="button" id="export-excel-entries" class="excel-export" style="display: none;">–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
            </div>
        </div>

        <table id="entries-table">
            <thead>
            <tr>
                <th>–°–∫–ª–∞–¥</th>
                <th>–î–∞—Ç–∞</th>
                <th>–í–æ–¥—ñ–π</th>
                <th>–¢–æ–≤–∞—Ä</th>
                <th>–¢–∏–ø</th>
                <th>–ü—Ä–∏–≤–µ–∑–µ–Ω–æ</th>
                <th>–ó–∞–∫—É–ø–ª–µ–Ω–æ</th>
                <th>–†—ñ–∑–Ω–∏—Ü—è</th>
                <th>–í–∞—Ä—Ç—ñ—Å—Ç—å</th>
            </tr>
            </thead>
            <tbody id="entries-body"></tbody>
        </table>

        <div class="pagination">
            <button id="entries-prev-page" disabled>–ü–æ–ø–µ—Ä–µ–¥–Ω—è</button>
            <span id="entries-page-info">–°—Ç–æ—Ä—ñ–Ω–∫–∞ 1 –∑ 1</span>
            <button id="entries-next-page" disabled>–ù–∞—Å—Ç—É–ø–Ω–∞</button>
        </div>
    </div>


    <div id="transfers-container" class="transfers-container" style="display: none;">
        <div class="transfers-header">
            <h3>–Ü—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–º—ñ—â–µ–Ω—å</h3>
            <div class="transfers-filter-controls">
                <button class="open-filter-modal-btn" id="open-transfers-filter-modal" style="display: none;">–§—ñ–ª—å—Ç—Ä–∏ –ø–µ—Ä–µ–º—ñ—â–µ–Ω—å</button>
                <span id="transfers-filter-counter" style="display: none;">
                    <span id="transfers-filter-count">0</span>
                    <svg width="10" height="10" viewBox="0 0 10 10">
                        <path d="M1 1l8 8M9 1l-8 8" stroke="white" stroke-width="2"/>
                    </svg>
                </span>
                <button type="button" id="export-excel-transfers" class="excel-export" style="display: none;">–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
            </div>
        </div>
        <table class="transfers-table" id="transfers-table">
            <thead>
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–°–∫–ª–∞–¥</th>
                <th>–ó —Ç–æ–≤–∞—Ä—É</th>
                <th>–î–æ —Ç–æ–≤–∞—Ä—É</th>
                <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                <th>–¶—ñ–Ω–∞ –∑–∞ –∫–≥</th>
                <th>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</th>
                <th>–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å</th>
                <th>–ü—Ä–∏—á–∏–Ω–∞</th>
                <th>–û–ø–∏—Å</th>
            </tr>
            </thead>
            <tbody id="transfers-body"></tbody>
        </table>
        <div class="pagination transfers-pagination">
            <button id="transfers-prev-page" disabled>–ü–æ–ø–µ—Ä–µ–¥–Ω—è</button>
            <span id="transfers-page-info">–°—Ç–æ—Ä—ñ–Ω–∫–∞ 1 –∑ 1</span>
            <button id="transfers-next-page" disabled>–ù–∞—Å—Ç—É–ø–Ω–∞</button>
        </div>
    </div>
</div>

<div id="balance-edit-modal" class="modal">
    <div class="modal-content large-modal">
        <span class="close">√ó</span>
        <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –±–∞–ª–∞–Ω—Å —Ç–æ–≤–∞—Ä—É</h3>
        
        <form id="balance-edit-form" class="balance-edit-form">
            <input type="hidden" id="balance-edit-warehouse-id">
            <input type="hidden" id="balance-edit-product-id">
            <div class="edit-mode-switch">
                <label class="edit-mode-label active">
                    <input type="radio" name="balance-edit-mode" value="quantity" checked>
                    –ó–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å
                </label>
                <label class="edit-mode-label">
                    <input type="radio" name="balance-edit-mode" value="totalCost">
                    –ó–º—ñ–Ω–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å
                </label>
            </div>
            <div class="form-row">
                <label for="balance-edit-quantity">–ù–æ–≤–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
                <input type="number" id="balance-edit-quantity" step="0.01" min="0">
            </div>
            <div class="form-row">
                <label for="balance-edit-total-cost">–ù–æ–≤–∞ –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å (–≥—Ä–Ω):</label>
                <input type="number" id="balance-edit-total-cost" step="0.000001" min="0" disabled>
            </div>
            <div class="form-row">
                <label for="balance-edit-description">–ö–æ–º–µ–Ω—Ç–∞—Ä:</label>
                <textarea id="balance-edit-description" rows="2" placeholder="–ö–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∑–º—ñ–Ω–∏ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)"></textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="button">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
            <div class="balance-edit-actions">
                <button type="button" class="button button-secondary" id="balance-history-btn">–Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω</button>
            </div>
        </form>
    </div>
</div>

<div id="balance-history-modal" class="modal">
    <div class="modal-content large-modal">
        <span class="close">√ó</span>
        <h3>–Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω –±–∞–ª–∞–Ω—Å—É</h3>
        <div class="balance-history-wrapper">
            <table class="balance-history-table">
                <thead>
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</th>
                    <th>–¢–∏–ø</th>
                    <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                    <th>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</th>
                    <th>–°–µ—Ä–µ–¥–Ω—è —Ü—ñ–Ω–∞</th>
                    <th>–ö–æ–º–µ–Ω—Ç–∞—Ä</th>
                </tr>
                </thead>
                <tbody id="balance-history-body"></tbody>
            </table>
            <p id="balance-history-empty" style="display: none; text-align: center; margin-top: 10px;">–ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è</p>
        </div>
    </div>
</div>

<div id="withdraw-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–°–ø–∏—Å–∞–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É</h3>
        <form id="withdraw-form">
            <label for="withdrawal-date">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è:</label>
            <input type="date" id="withdrawal-date" required>

            <label for="withdrawal-reason-id">–ü—Ä–∏—á–∏–Ω–∞ —Å–ø–∏—Å–∞–Ω–Ω—è:</label>
            <select id="withdrawal-reason-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å –ø—Ä–∏—á–∏–Ω—É</option>
            </select>

            <label for="product-id">–¢–æ–≤–∞—Ä:</label>
            <select id="product-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å —Ç–æ–≤–∞—Ä</option>
            </select>

            <label for="warehouse-id">–°–∫–ª–∞–¥:</label>
            <select id="warehouse-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å c–∫–ª–∞–¥</option>
            </select>

            <label for="quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
            <input type="number" id="quantity" step="0.01" min="0" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥)" required>

            <label for="description">–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ–ø–∏—Å:</label>
            <textarea id="description" placeholder="–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ–ø–∏—Å"></textarea>

            <button type="submit" class="button">–°–ø–∏—Å–∞—Ç–∏</button>
        </form>
    </div>
</div>

<div id="edit-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Å–ø–∏—Å–∞–Ω–Ω—è</h3>
        <form id="edit-form">
            <input type="hidden" id="edit-id">
            <input type="hidden" id="edit-withdrawal-date">
            <div class="readonly-field">
                <span class="readonly-label">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è:</span>
                <span id="edit-withdrawal-date-display" class="readonly-value"></span>
            </div>
            <div class="readonly-field">
                <span class="readonly-label">–¢–æ–≤–∞—Ä:</span>
                <span id="edit-withdrawal-product-name" class="readonly-value"></span>
            </div>

            <label for="edit-withdrawal-reason-id">–ü—Ä–∏—á–∏–Ω–∞ —Å–ø–∏—Å–∞–Ω–Ω—è:</label>
            <select id="edit-withdrawal-reason-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å –ø—Ä–∏—á–∏–Ω—É</option>
            </select>

            <label for="edit-quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
            <input type="number" id="edit-quantity" step="0.01" min="0" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥)" required>

            <label for="edit-description">–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ–ø–∏—Å:</label>
            <textarea id="edit-description" placeholder="–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ–ø–∏—Å"></textarea>

            <button type="submit" class="button">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>

<div id="move-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É</h3>
        <form id="move-form">
            <label for="move-warehouse-id">–°–∫–ª–∞–¥:</label>
            <select id="move-warehouse-id" name="warehouse_id" required></select>

            <label for="move-date">–î–∞—Ç–∞:</label>
            <input type="date" id="move-date" name="move_date" required>

            <label for="move-executor-id">–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å:</label>
            <select id="move-executor-id" name="executor_id" required></select>

            <label for="move-type-id">–¢–∏–ø:</label>
            <select id="move-type-id" name="type_id" required></select>

            <label for="move-from-product-id">–¢–æ–≤–∞—Ä –∑ —è–∫–æ–≥–æ –∑–Ω—ñ–º–∞—î—Ç—å—Å—è:</label>
            <select id="move-from-product-id" name="from_product_id" required></select>

            <label for="move-to-product-id">–¢–æ–≤–∞—Ä –¥–æ —è–∫–æ–≥–æ –¥–æ–¥–∞—î—Ç—å—Å—è:</label>
            <select id="move-to-product-id" name="to_product_id" required></select>

            <label for="move-quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É (–∫–≥):</label>
            <input type="number" id="move-quantity" name="quantity" step="0.01" min="0" required>

            <label for="move-description">–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ–ø–∏—Å:</label>
            <textarea id="move-description" name="description" placeholder="–û–ø–∏—Å –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è"></textarea>

            <button type="submit" class="button">–ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏</button>
        </form>
    </div>
</div>

<div id="entry-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–î–æ–¥–∞—Ç–∏ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è</h3>
        <form id="entry-form">
            <label for="entry-warehouse-id">–°–∫–ª–∞–¥:</label>
            <select id="entry-warehouse-id" name="warehouse_id" required></select>

            <label for="entry-date">–î–∞—Ç–∞:</label>
            <input type="date" id="entry-date" name="entry_date" required>

            <label for="entry-user-id">–í–æ–¥—ñ–π:</label>
            <select id="entry-user-id" name="user_id" required></select>

            <label for="entry-product-id">–¢–æ–≤–∞—Ä:</label>
            <select id="entry-product-id" name="product_id" required></select>

            <label for="entry-type-id">–¢–∏–ø:</label>
            <select id="entry-type-id" name="type_id" required></select>

            <label for="entry-quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
            <input type="number" id="entry-quantity" name="quantity" step="0.01" min="0" required>

            <button type="submit" class="button">–î–æ–¥–∞—Ç–∏</button>
        </form>
    </div>
</div>

<div class="filter-modal" id="history-filter-modal">
    <div class="modal-content">
        <span class="modal-close" id="history-filter-modal-close">√ó</span>
        <h3>–§—ñ–ª—å—Ç—Ä–∏ —Å–ø–∏—Å–∞–Ω–∏–π:</h3>
        <form id="history-filter-form">
            <div class="filters">
                <div class="filter-group">
                    <div class="filter-block">
                        <label for="history-withdrawal-date-from-filter">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è –≤—ñ–¥:</label>
                        <input type="date" id="history-withdrawal-date-from-filter" name="withdrawal_date_from">
                    </div>
                    <div class="filter-block">
                        <label for="history-withdrawal-date-to-filter">–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è –¥–æ:</label>
                        <input type="date" id="history-withdrawal-date-to-filter" name="withdrawal_date_to">
                    </div>
                    <div class="select-section-items">
                        <div class="select-section-item">
                            <label for="history-product-id-filter">–¢–æ–≤–∞—Ä:</label>
                            <select id="history-product-id-filter" name="product_id" multiple></select>
                        </div>
                        <div class="select-section-item">
                            <label for="history-warehouse-id-filter">–°–∫–ª–∞–¥:</label>
                            <select id="history-warehouse-id-filter" name="warehouse_id" multiple></select>
                        </div>
                        <div class="select-section-item">
                            <label for="history-withdrawal-reason-id-filter">–ü—Ä–∏—á–∏–Ω–∞:</label>
                            <select id="history-withdrawal-reason-id-filter" name="withdrawal_reason_id" multiple></select>
                        </div>
                    </div>
                </div>
                <div class="filter-actions">
                    <button type="button" id="apply-history-filters" class="apply-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="filter-modal" id="entries-filter-modal">
    <div class="modal-content">
        <span class="modal-close" id="entries-filter-modal-close">√ó</span>
        <h3>–§—ñ–ª—å—Ç—Ä–∏ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω—å:</h3>
        <form id="entries-filter-form">
            <div class="filters">
                <div class="filter-group">
                    <div class="filter-block">
                        <label for="entries-entry-date-from-filter">–î–∞—Ç–∞ –≤—ñ–¥:</label>
                        <input type="date" id="entries-entry-date-from-filter" name="entry_date_from">
                    </div>
                    <div class="filter-block">
                        <label for="entries-entry-date-to-filter">–î–∞—Ç–∞ –¥–æ:</label>
                        <input type="date" id="entries-entry-date-to-filter" name="entry_date_to">
                    </div>
                    <div class="select-section-items">
                        <div class="select-section-item">
                            <label for="entries-user-id-filter">–í–æ–¥—ñ–π:</label>
                            <select id="entries-user-id-filter" name="user_id" multiple></select>
                        </div>
                        <div class="select-section-item">
                            <label for="entries-product-id-filter">–¢–æ–≤–∞—Ä:</label>
                            <select id="entries-product-id-filter" name="product_id" multiple></select>
                        </div>
                        <div class="select-section-item">
                            <label for="entries-warehouse-id-filter">–°–∫–ª–∞–¥:</label>
                            <select id="entries-warehouse-id-filter" name="warehouse_id" multiple></select>
                        </div>
                        <div class="select-section-item">
                            <label for="entries-type-filter">–¢–∏–ø:</label>
                            <select id="entries-type-filter" name="type" multiple></select>
                        </div>
                    </div>
                </div>
                <div class="filter-actions">
                    <button type="button" id="apply-entries-filters" class="apply-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="filter-modal" id="transfers-filter-modal">
    <div class="modal-content">
        <span class="modal-close" id="transfers-filter-modal-close">√ó</span>
        <h3>–§—ñ–ª—å—Ç—Ä–∏ –ø–µ—Ä–µ–º—ñ—â–µ–Ω—å:</h3>
        <form id="transfers-filter-form">
            <div class="filters">
                <div class="filter-group">
                    <div class="filter-block">
                        <label for="transfer-date-from-filter">–î–∞—Ç–∞ –≤—ñ–¥:</label>
                        <input type="date" id="transfer-date-from-filter" name="transfer_date_from">
                    </div>
                    <div class="filter-block">
                        <label for="transfer-date-to-filter">–î–∞—Ç–∞ –¥–æ:</label>
                        <input type="date" id="transfer-date-to-filter" name="transfer_date_to">
                    </div>
                    <div class="select-section-items">
                        <div class="select-section-item">
                            <label for="transfer-warehouse-filter">–°–∫–ª–∞–¥:</label>
                            <select id="transfer-warehouse-filter" name="warehouse_id"></select>
                        </div>
                        <div class="select-section-item">
                            <label for="transfer-from-product-filter">–ó —Ç–æ–≤–∞—Ä—É:</label>
                            <select id="transfer-from-product-filter" name="from_product_id"></select>
                        </div>
                        <div class="select-section-item">
                            <label for="transfer-to-product-filter">–î–æ —Ç–æ–≤–∞—Ä—É:</label>
                            <select id="transfer-to-product-filter" name="to_product_id"></select>
                        </div>
                        <div class="select-section-item">
                            <label for="transfer-user-filter">–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å:</label>
                            <select id="transfer-user-filter" name="user_id"></select>
                        </div>
                        <div class="select-section-item">
                            <label for="transfer-reason-filter">–ü—Ä–∏—á–∏–Ω–∞:</label>
                            <select id="transfer-reason-filter" name="reason_id"></select>
                        </div>
                    </div>
                </div>
                <div class="filter-actions">
                    <button type="button" id="apply-transfer-filters" class="apply-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                    <button type="button" id="clear-transfer-filters" class="button">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div id="driver-balances-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–ë–∞–ª–∞–Ω—Å–∏ –≤–æ–¥—ñ—ó–≤</h3>
        <div id="driver-balances-container"></div>
    </div>
</div>

<!-- Discrepancies Modal -->
<div id="discrepancies-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–í—Ç—Ä–∞—Ç–∏ —Ç–∞ –ø—Ä–∏–¥–±–∞–Ω–Ω—è –ø—Ä–∏ –ø—Ä–∏–π–º–∞–Ω–Ω—ñ —Ç–æ–≤–∞—Ä—É</h3>

        <div class="discrepancies-body-content">

        <!-- Statistics -->
        <div id="discrepancies-stats">
                <div class="discrepancy-stat-card loss">
                    <div class="discrepancy-stat-label">–ó–∞–≥–∞–ª—å–Ω—ñ –≤—Ç—Ä–∞—Ç–∏</div>
                    <div class="discrepancy-stat-value" id="total-losses-value">0 –≥—Ä–Ω</div>
                    <div class="discrepancy-stat-count" id="total-losses-count">0 –∑–∞–ø–∏—Å—ñ–≤</div>
                </div>
                <div class="discrepancy-stat-card gain">
                    <div class="discrepancy-stat-label">–ó–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–∏–¥–±–∞–Ω–Ω—è</div>
                    <div class="discrepancy-stat-value" id="total-gains-value">0 –≥—Ä–Ω</div>
                    <div class="discrepancy-stat-count" id="total-gains-count">0 –∑–∞–ø–∏—Å—ñ–≤</div>
                </div>
            <div class="discrepancy-stat-card net">
                <div class="discrepancy-stat-label">–ß–∏—Å—Ç–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                <div class="discrepancy-stat-value" id="net-value">0 –≥—Ä–Ω</div>
            </div>
        </div>
        
        <!-- Filters -->
        <div id="discrepancies-filters">
            <div class="filters-row">
                <div class="discrepancy-filter-group">
                    <label>–¢–∏–ø</label>
                    <select id="discrepancy-type-filter">
                        <option value="">–í—Å—ñ</option>
                        <option value="LOSS">–í—Ç—Ä–∞—Ç–∏</option>
                        <option value="GAIN">–ü—Ä–∏–¥–±–∞–Ω–Ω—è</option>
                    </select>
                </div>
                <div class="discrepancy-filter-group">
                    <label>–î–∞—Ç–∞ –≤—ñ–¥</label>
                    <input type="date" id="discrepancy-date-from">
                </div>
                <div class="discrepancy-filter-group">
                    <label>–î–∞—Ç–∞ –¥–æ</label>
                    <input type="date" id="discrepancy-date-to">
                </div>
                <button id="apply-discrepancy-filters" class="button">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                <button id="reset-discrepancy-filters" class="button">–°–∫–∏–Ω—É—Ç–∏</button>
                <button id="export-discrepancies-excel" class="button" style="background: #2E7D32; margin-left: 10px;">
                    üìä –ï–∫—Å–ø–æ—Ä—Ç –≤ Excel
                </button>
            </div>
        </div>
        
        <!-- Table -->
        <div id="discrepancies-container">
            <table class="balance-table">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–í–æ–¥—ñ–π</th>
                        <th>–¢–æ–≤–∞—Ä</th>
                        <th>–°–∫–ª–∞–¥</th>
                        <th>–ó–∞–∫—É–ø–ª–µ–Ω–æ</th>
                        <th>–ü—Ä–∏–π–Ω—è—Ç–æ</th>
                        <th>–†—ñ–∑–Ω–∏—Ü—è</th>
                        <th>–¶—ñ–Ω–∞/–∫–≥</th>
                        <th>–í–∞—Ä—Ç—ñ—Å—Ç—å</th>
                        <th>–¢–∏–ø</th>
                    </tr>
                </thead>
                <tbody id="discrepancies-table-body">
                    <!-- Data will be loaded here -->
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        <div id="discrepancies-pagination">
            <div>
                <span id="discrepancies-info">–ü–æ–∫–∞–∑–∞–Ω–æ 0 –∑ 0</span>
            </div>
            <div class="discrepancies-pagination-buttons">
                <button id="discrepancies-prev" class="button">–ü–æ–ø–µ—Ä–µ–¥–Ω—è</button>
                <span id="discrepancies-page-numbers"></span>
                <button id="discrepancies-next" class="button">–ù–∞—Å—Ç—É–ø–Ω–∞</button>
            </div>
        </div>
        </div>
    </div>
</div>

<div id="shipments-container" class="shipments-container" style="display: none;">
        <div class="shipments-header">
            <h3>–í—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞—à–∏–Ω</h3>
            <div class="shipments-controls">
                <button class="button" id="create-shipment-btn">–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—à–∏–Ω—É</button>
                <div class="shipments-filters">
                    <label>–î–∞—Ç–∞ –≤—ñ–¥:</label>
                    <input type="date" id="shipments-date-from">
                    <label>–î–∞—Ç–∞ –¥–æ:</label>
                    <input type="date" id="shipments-date-to">
                    <button class="button" id="apply-shipments-filters">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                </div>
            </div>
        </div>
        
        <table class="shipments-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞ –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</th>
                    <th>–ù–æ–º–µ—Ä –º–∞—à–∏–Ω–∏</th>
                    <th>–Ü–Ω–≤–æ–π—Å –£–ê</th>
                    <th>–Ü–Ω–≤–æ–π—Å –Ñ–°</th>
                    <th>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</th>
                    <th>–ö–æ–º–µ–Ω—Ç–∞—Ä</th>
                </tr>
            </thead>
            <tbody id="shipments-tbody">
                <!-- Will be filled dynamically -->
            </tbody>
        </table>
    </div>
</div>

<!-- Create Shipment Modal -->
<div id="create-shipment-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—à–∏–Ω—É</h3>
        <form id="create-shipment-form">
            <label for="shipment-date">–î–∞—Ç–∞ –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:</label>
            <input type="date" id="shipment-date" required>
            
            <label for="shipment-vehicle-number">–ù–æ–º–µ—Ä –º–∞—à–∏–Ω–∏:</label>
            <input type="text" id="shipment-vehicle-number">
            
            <label for="shipment-invoice-ua">–Ü–Ω–≤–æ–π—Å –£–ê:</label>
            <input type="text" id="shipment-invoice-ua">
            
            <label for="shipment-invoice-eu">–Ü–Ω–≤–æ–π—Å –Ñ–°:</label>
            <input type="text" id="shipment-invoice-eu">
            
            <label for="shipment-description">–ö–æ–º–µ–Ω—Ç–∞—Ä:</label>
            <textarea id="shipment-description" rows="3"></textarea>
            
            <button type="submit" class="button">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
        </form>
    </div>
</div>

<!-- Shipment Details Modal -->
<div id="shipment-details-modal" class="modal">
    <div class="modal-content large-modal">
        <span class="close">√ó</span>
        <h3>–î–µ—Ç–∞–ª—ñ –º–∞—à–∏–Ω–∏</h3>
        
        <div id="shipment-info">
            <form id="update-shipment-form" class="shipment-info-form">
                <div class="form-row">
                    <label for="detail-shipment-date">–î–∞—Ç–∞ –≤—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:</label>
                    <input type="date" id="detail-shipment-date" required disabled>
                </div>
                <div class="form-row">
                    <label for="detail-shipment-vehicle-number">–ù–æ–º–µ—Ä –º–∞—à–∏–Ω–∏:</label>
                    <input type="text" id="detail-shipment-vehicle-number" disabled>
                </div>
                <div class="form-row">
                    <label for="detail-shipment-invoice-ua">–Ü–Ω–≤–æ–π—Å –£–ê:</label>
                    <input type="text" id="detail-shipment-invoice-ua" disabled>
                </div>
                <div class="form-row">
                    <label for="detail-shipment-invoice-eu">–Ü–Ω–≤–æ–π—Å –Ñ–°:</label>
                    <input type="text" id="detail-shipment-invoice-eu" disabled>
                </div>
                <div class="form-row">
                    <label for="detail-shipment-description">–ö–æ–º–µ–Ω—Ç–∞—Ä:</label>
                    <textarea id="detail-shipment-description" rows="3" disabled></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="button button-secondary" id="edit-shipment-btn">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="button" id="save-shipment-btn" style="display: none;">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
                </div>
            </form>
        </div>

        <div class="shipment-items-body">
        <h4>–¢–æ–≤–∞—Ä–∏ –≤ –º–∞—à–∏–Ω—ñ</h4>
        <table class="shipment-items-table">
            <thead>
                <tr>
                    <th>–¢–æ–≤–∞—Ä</th>
                    <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                    <th>–¶—ñ–Ω–∞ –∑–∞ –∫–≥</th>
                    <th>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</th>
                    <th>–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–Ω—è</th>
                </tr>
            </thead>
            <tbody id="shipment-items-tbody">
                <!-- Will be filled dynamically -->
            </tbody>
        </table>
        
        <div class="shipment-total">
            <strong>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –º–∞—à–∏–Ω–∏: <span id="shipment-total-cost">0</span> –≥—Ä–Ω</strong>
        </div>
        
        <div class="shipment-actions-bottom">
            <button class="button" id="add-product-to-shipment-btn">–î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</button>
            <button class="button button-danger" id="delete-shipment-btn">–í–∏–¥–∞–ª–∏—Ç–∏ –º–∞—à–∏–Ω—É</button>
        </div>
            </div>
    </div>
</div>

<!-- Add Product to Shipment Modal -->
<div id="add-product-to-shipment-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä –¥–æ –º–∞—à–∏–Ω–∏</h3>
        <form id="add-product-to-shipment-form">
            <label for="shipment-warehouse-id">–°–∫–ª–∞–¥:</label>
            <select id="shipment-warehouse-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å —Å–∫–ª–∞–¥</option>
            </select>

            <label for="shipment-product-id">–¢–æ–≤–∞—Ä:</label>
            <select id="shipment-product-id" required>
                <option value="">–û–±–µ—Ä—ñ—Ç—å —Ç–æ–≤–∞—Ä</option>
            </select>

            <label for="shipment-quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
            <input type="number" id="shipment-quantity" step="0.01" min="0.01" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥)" required>

            <button type="submit" class="button">–î–æ–¥–∞—Ç–∏</button>
        </form>
    </div>
</div>

<!-- Edit Shipment Item Modal -->
<div id="edit-shipment-item-modal" class="modal">
    <div class="modal-content">
        <span class="close">√ó</span>
        <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–æ–≤–∞—Ä —É –º–∞—à–∏–Ω—ñ</h3>
        <form id="edit-shipment-item-form">
            <div class="edit-mode-switch">
                <label>
                    <input type="radio" name="edit-shipment-item-mode" value="quantity" checked>
                    –ó–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å
                </label>
                <label>
                    <input type="radio" name="edit-shipment-item-mode" value="totalCost">
                    –ó–º—ñ–Ω–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å
                </label>
            </div>

            <div class="form-row">
                <label for="edit-shipment-item-quantity">–ù–æ–≤–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥):</label>
                <input type="number" id="edit-shipment-item-quantity" step="0.01" min="0" disabled>
            </div>

            <div class="form-row">
                <label for="edit-shipment-item-total-cost">–ù–æ–≤–∞ –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å (–≥—Ä–Ω):</label>
                <input type="number" id="edit-shipment-item-total-cost" step="0.000001" min="0" disabled>
            </div>

            <div class="form-actions">
                <button type="submit" class="button">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </form>
    </div>
</div>

<div id="loader-backdrop" class="loader-backdrop" style="display: none;">
    <div id="loader" class="loader"></div>
</div>

<script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="/js/stock.js"></script>
<script src="/js/common.js"></script>
<script src="/js/error.js"></script>

</body>
</html>